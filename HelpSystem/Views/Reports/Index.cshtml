@model dynamic

@{
    ViewBag.Title = "title";
    Layout = "_Layout";
}


<link rel="stylesheet" href="~/JQUERY/jquery.datetimepicker.min.css"/>
<style>
    /* Добавляем стили для рамки и анимации */
    .nav-pills {
        display: none;
        border: 2px solid #ced4da; /* Добавляем рамку */
        box-shadow: 0 2px 4px rgba(0, 0, 11, 0.1); /* Добавляем тень */
        border-radius: 10px; /* Добавляем скругление углов */
    }
</style>
<ul class="nav nav-pills">
    <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownReports" role="button" data-bs-toggle="dropdown" aria-expanded="false">Отчёты</a>
        <ul class="dropdown-menu" aria-labelledby="navbarDropdownReports">
            <li><a class="dropdown-item" href="#">Отчёт по пользователю</a></li>
            <li><a class="dropdown-item" href="#">Отчёт по пользователям</a></li>
            <li><a class="dropdown-item" href="#" id="openDatePicker">Отчёт по поступлениям</a></li>
        </ul>
    </li>
</ul>
@section Scripts
{
    <script src="~/JQUERY/jquery.datetimepicker.full.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
    <script>

        // $.datetimepicker.setLocale('ru');
        // $("#datetimepicker").datetimepicker({
        //     format: 'd.m.Y', // Формат даты (день.месяц.год)
        //     timepicker: false, // Отключение времени
        //     minDate:'-1970/01/02'
            
        // });
    </script>
    <script>
        $.datetimepicker.setLocale('ru');
        // Добавляем анимацию с помощью jQuery
        $(document).ready(function(){
            $('.nav-pills').slideDown(500);


        });
      
        // Функция для открытия диалогового окна и выбора даты с помощью flatpickr
        $(document).on("click", "#openDatePicker", function () {
            const startDateInput = $('<input>').attr({
                type: 'text',
                id: 'startDate',
                class: 'form-control mb-2',
                placeholder: 'Начальная дата'
            });
            const endDateInput = $('<input>').attr({
                type: 'text',
                id: 'endDate',
                class: 'form-control',
                placeholder: 'Конечная дата'
            });

            Swal.fire({
                title: 'Выберите даты',
                html: startDateInput[0].outerHTML + endDateInput[0].outerHTML,
                focusConfirm: false,
                didOpen: () => {
                    $('#startDate').datetimepicker({
                        format: 'd.m.Y', // Формат даты (день.месяц.год)
                        timepicker: false // Отключение времени
                      
                    });

                    $('#endDate').datetimepicker({
                        format: 'd.m.Y', // Формат даты (день.месяц.год)
                        timepicker: false // Отключение времени
                     
                    });
                },
                preConfirm: () => {
                    const startDate = $('#startDate').val();
                    const endDate = $('#endDate').val();

                    // Проверяем, если конечная дата меньше начальной, выдаем ошибку
                    if (startDate > endDate) {
                        // Ошибка: Конечная дата не может быть меньше начальной
                        Swal.fire({
                            icon: 'error',
                            title: 'Ошибка',
                            text: 'Конечная дата не может быть меньше начальной.'
                        });
                        return false ;
                    }

                    return true;
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    const startDate = result.value[0];
                    const endDate = result.value[1];
                    // Теперь можно использовать startDate и endDate для выполнения нужной логики
                    console.log("Начальная дата:", startDate);
                    console.log("Конечная дата:", endDate);
                }
            });
        });
    </script>
}
